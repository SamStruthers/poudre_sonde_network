---
title: "Standard Deviation Flag"
author: "ROSSyndicate"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  markdown: 
    wrap: 90
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, error = FALSE, message = FALSE) 
```

# Standard Deviation Flag

#### The slope deviation flag is triggered when the mean value of a specific data row deviates by more than 3 standard deviations from the rolling average.

```{r, eval=FALSE}
# SD flag
add_flag((mean <= rollavg - (3 * m_sd_1090) | mean >= rollavg + (3 * m_sd_1090)), 
         "outside sd range")
```

_where_ :
- `mean` = the average of all the data points collected in a 15 minute period for a sonde parameter.
- `rollavg` = a rolling window average of 7 data points, with the data point that is being evaluated in the center.
- `m_sd_1090` = The seasonal standard deviation within the 10th and 90th quantiles for the season.
- "outside sd range" = flag descriptor inserted into `flag` column.

## Examples:

### Good
```{r}
generate_daily_flag_plots("timberline", "Turbidity", "outside sd range")[[7]]
```
- Extreme outliers will be detected and deemed unsuitable.
- This flag is often associated with the seasonal range flag.
- This flag is often associated with the slope violation flag.

### Bad
```{r}
generate_daily_flag_plots("timberline", "Turbidity", "outside sd range")[[51]]
```
- When several points are following a suspicious trend they are captured in the rolling average window and do not get flagged.
- Fortunately, as this flag is often associated with other flags, those other flags will get triggered as well.
